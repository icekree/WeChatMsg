# WeChatMsg 超简单Web界面

## 🎯 功能特点

一个超级简单的Web界面，集成了WeChatMsg的所有核心功能：

- ✅ **微信数据解密** - 一键检测并解密微信数据库
- ✅ **联系人管理** - 可视化显示所有联系人和群聊
- ✅ **聊天记录导出** - 支持多种格式（HTML、TXT、Word、Excel、Markdown）
- ✅ **批量处理** - 支持批量导出所有联系人的聊天记录
- ✅ **实时日志** - 详细的操作日志和状态显示

## 🚀 快速启动

### 方法一：一键启动（推荐）
1. 双击 `启动界面.bat` 文件
2. 等待依赖安装完成
3. 浏览器自动打开 http://localhost:8888

### 方法二：手动启动
```bash
# 安装Web依赖
pip install fastapi uvicorn[standard]

# 启动Web服务
python web_ui.py
```

## 📋 使用步骤

### 第一步：解密微信数据
1. **确保微信正在运行**
2. 点击 "🔓 检测并解密微信数据" 按钮
3. 等待解密完成，界面会显示微信用户信息

### 第二步：加载联系人
1. 点击 "📋 加载联系人列表" 按钮
2. 等待联系人列表加载完成
3. 从列表中选择要导出的联系人

### 第三步：导出聊天记录
1. 选择导出格式（HTML、TXT、Word等）
2. 点击 "📤 导出聊天记录" 导出单个联系人
3. 或点击 "📦 批量导出全部" 导出所有联系人

## 📁 输出文件

导出的文件保存在 `./exported_data/` 目录下：
- HTML格式：可以在浏览器中查看，还原微信聊天界面
- TXT格式：纯文本格式，方便阅读和搜索
- Word格式：可以在Microsoft Word中编辑
- Excel格式：表格形式，便于数据分析
- Markdown格式：支持各种Markdown编辑器

## ⚠️ 注意事项

1. **管理员权限**：首次运行建议以管理员身份运行，因为需要访问微信进程内存
2. **微信版本**：目前支持微信3.x版本，微信4.0支持正在开发中
3. **网络端口**：默认使用8888端口，如果被占用会自动提示
4. **数据安全**：所有操作都在本地进行，不会上传任何数据

## 🔧 技术架构

- **后端**：FastAPI + Python
- **前端**：纯HTML + JavaScript（无需额外框架）
- **核心模块**：复用WeChatMsg原有的所有功能模块

## 💡 界面预览

```
🔥 WeChatMsg 聊天记录工具

📱 第一步：解密微信数据
[🔓 检测并解密微信数据] [🔄 刷新状态]
✅ 解密成功！用户: KREE 微信号: icekree

👥 第二步：查看联系人  
[📋 加载联系人列表] 数据库状态: 已连接
✅ 已加载 156 个联系人

💾 第三步：导出聊天记录
[HTML格式 ▼] [选择的联系人] [📤 导出聊天记录] [📦 批量导出全部]
✅ 导出成功！文件保存在: ./exported_data/

📊 操作日志
[12:34:56] WeChatMsg Web UI 已启动
[12:35:12] 解密成功: KREE (icekree)
[12:35:20] 加载联系人成功: 156 个
```

## 🆘 常见问题

**Q: 提示"未找到微信进程"？**
A: 请确保微信客户端正在运行，并且是3.x版本

**Q: 解密失败？**
A: 请以管理员身份运行，或者重启微信后重试

**Q: 联系人加载失败？**
A: 请先完成第一步的数据解密操作

**Q: 导出的文件在哪里？**
A: 默认保存在项目目录下的 `exported_data` 文件夹中

## 🔄 更新日志

- v1.0.0: 初始版本，集成所有核心功能
- 支持微信3.x数据解密
- 支持5种导出格式
- 支持批量处理
- 实时操作日志

---

**享受简单高效的微信数据管理体验！** 🎉